(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[627],{8604:function(e,t,o){Promise.resolve().then(o.bind(o,5627))},5627:function(e,t,o){"use strict";o.r(t),o.d(t,{default:function(){return b}});var n=o(7437),l=o(2265),r=o(1942);let s=(0,l.createContext)(),c=()=>(0,l.useContext)(s),a=e=>{let{children:t}=e,[o,r]=(0,l.useState)(1);(0,l.useEffect)(()=>{let e=localStorage.getItem("widgets-scale");e&&r(parseFloat(e))},[]);let c=e=>{let t=Math.max(.4,Math.min(2,e));r(t),localStorage.setItem("widgets-scale",t.toString())};return(0,n.jsx)(s.Provider,{value:{scale:o,increaseScale:()=>{c(o+.1)},decreaseScale:()=>{c(o-.1)}},children:t})},i=(e,t)=>{let[o,n]=(0,l.useState)(t),[r,s]=(0,l.useState)(!1),c=(0,l.useRef)({x:0,y:0}),[a,i]=(0,l.useState)(!1);(0,l.useEffect)(()=>{let t=localStorage.getItem(e);t&&n(JSON.parse(t)),i(!0)},[e]);let d=(0,l.useCallback)(e=>{s(!0),c.current={x:e.clientX-o.x,y:e.clientY-o.y}},[o]),u=(0,l.useCallback)(e=>{r&&n({x:e.clientX-c.current.x,y:e.clientY-c.current.y})},[r]),m=(0,l.useCallback)(()=>{r&&(s(!1),localStorage.setItem(e,JSON.stringify(o)))},[r,o,e]);return(0,l.useEffect)(()=>(window.addEventListener("mousemove",u),window.addEventListener("mouseup",m),()=>{window.removeEventListener("mousemove",u),window.removeEventListener("mouseup",m)}),[u,m]),{position:o,isLoaded:a,handleMouseDown:d}};function d(){let[e,t]=(0,l.useState)(!0),{scale:o}=c(),{position:s,isLoaded:a,handleMouseDown:d}=i("widget-builds",{x:0,y:50}),[u,m]=(0,l.useState)("Inicia una partida para recibir consejos.");return((0,l.useEffect)(()=>(window.electronAPI&&window.electronAPI.on("new-build-advice",e=>{e&&e.recommendedItem&&m("Pr\xf3ximo objeto recomendado: ".concat(e.recommendedItem))}),()=>{window.electronAPI&&"function"==typeof window.electronAPI.removeAllListeners&&window.electronAPI.removeAllListeners("new-build-advice")}),[]),a)?(0,n.jsxs)("div",{className:"absolute w-96 origin-top-left bg-lol-blue-dark/10 border-2 border-lol-gold rounded-md text-lol-gold-light shadow-lg backdrop-blur-sm",style:{top:"".concat(s.y,"px"),left:"".concat(s.x,"px"),transform:"scale(".concat(o,")"),cursor:e?"move":"default"},children:[(0,n.jsxs)("div",{className:"bg-lol-blue-dark p-2 flex justify-between items-center",onMouseDown:e?d:void 0,children:[(0,n.jsx)("h3",{className:"font-bold text-shadow-md",children:"Consejos de Build"}),(0,n.jsx)("button",{onClick:()=>t(!e),className:"text-lol-gold hover:text-white cursor-pointer",children:e?(0,n.jsx)(r.D5B,{}):(0,n.jsx)(r.kUi,{})})]}),(0,n.jsx)("div",{className:"p-4",children:(0,n.jsx)("p",{children:u})})]}):null}function u(){let[e,t]=(0,l.useState)(!0),{scale:o}=c(),{position:s,isLoaded:a,handleMouseDown:d}=i("widget-strategy",{x:0,y:250}),[u,m]=(0,l.useState)("Esperando an\xe1lisis estrat\xe9gico...");return((0,l.useEffect)(()=>(window.electronAPI&&window.electronAPI.on("new-strategy-advice",e=>{e&&e.advice&&m(e.advice)}),()=>{window.electronAPI&&"function"==typeof window.electronAPI.removeAllListeners&&window.electronAPI.removeAllListeners("new-strategy-advice")}),[]),a)?(0,n.jsxs)("div",{className:"absolute w-96 origin-top-left bg-lol-blue-dark/10 border-2 border-lol-gold rounded-md text-lol-gold-light shadow-lg backdrop-blur-sm",style:{top:"".concat(s.y,"px"),left:"".concat(s.x,"px"),transform:"scale(".concat(o,")"),cursor:e?"move":"default"},children:[(0,n.jsxs)("div",{className:"bg-lol-blue-dark p-2 flex justify-between items-center",onMouseDown:e?d:void 0,children:[(0,n.jsx)("h3",{className:"font-bold text-shadow-md",children:"Consejos Estrat\xe9gicos"}),(0,n.jsx)("button",{onClick:()=>t(!e),className:"text-lol-gold hover:text-white cursor-pointer",children:e?(0,n.jsx)(r.D5B,{}):(0,n.jsx)(r.kUi,{})})]}),(0,n.jsx)("div",{className:"p-4",children:(0,n.jsx)("p",{children:u})})]}):null}function m(){let[e,t]=(0,l.useState)(!0),{scale:o}=c(),{position:s,isLoaded:a,handleMouseDown:d}=i("widget-coach",{x:0,y:500}),[u,m]=(0,l.useState)("Iniciando MetaMind...");return((0,l.useEffect)(()=>(window.electronAPI&&(window.electronAPI.on("new-game-event",e=>{e&&e.message&&(console.log("Nuevo evento de coach:",e.message),m(e.message))}),window.electronAPI.on("new-coach-message",e=>{console.log("Nuevo mensaje de estado/coach:",e),m(e)})),()=>{window.electronAPI&&"function"==typeof window.electronAPI.removeAllListeners&&(window.electronAPI.removeAllListeners("new-game-event"),window.electronAPI.removeAllListeners("new-coach-message")),window.speechSynthesis.cancel()}),[]),a)?(0,n.jsxs)("div",{className:"absolute w-96 origin-top-left bg-lol-blue-dark/10 border-2 border-lol-gold rounded-md text-lol-gold-light shadow-lg backdrop-blur-sm",style:{top:"".concat(s.y,"px"),left:"".concat(s.x,"px"),transform:"scale(".concat(o,")"),cursor:e?"move":"default"},children:[(0,n.jsxs)("div",{className:"bg-lol-blue-dark p-2 flex justify-between items-center",onMouseDown:e?d:void 0,children:[(0,n.jsx)("h3",{className:"font-bold text-shadow-md",children:"Coach en Tiempo Real"}),(0,n.jsx)("button",{onClick:()=>t(!e),className:"text-lol-gold hover:text-white cursor-pointer",children:e?(0,n.jsx)(r.D5B,{}):(0,n.jsx)(r.kUi,{})})]}),(0,n.jsx)("div",{className:"p-4 relative min-h-[5rem]",children:(0,n.jsxs)("p",{className:"font-bold text-lol-blue-accent text-lg",children:["▶ ",u]})})]}):null}var w=o(2890),x=o.n(w);function g(){let{scale:e,increaseScale:t,decreaseScale:o}=c(),[s,a]=(0,l.useState)({x:10,y:10}),[i,d]=(0,l.useState)(!1),u=(0,l.useRef)(null);return((0,l.useEffect)(()=>{let e=localStorage.getItem("widget-controls");e&&a(JSON.parse(e)),d(!0)},[]),i)?(0,n.jsx)(x(),{nodeRef:u,handle:".drag-handle",defaultPosition:s,onStop:(e,t)=>{localStorage.setItem("widget-controls",JSON.stringify({x:t.x,y:t.y}))},children:(0,n.jsx)("div",{ref:u,className:"absolute origin-top-left",style:{transform:"scale(".concat(e,")")},children:(0,n.jsxs)("div",{className:"bg-lol-grey-dark/90 border border-lol-gold-dark rounded-md text-lol-gold-light shadow-lg backdrop-blur-sm flex items-center gap-2 p-1 cursor-move",children:[(0,n.jsx)("div",{className:"drag-handle px-1",children:"::"}),(0,n.jsx)("button",{onClick:o,className:"bg-lol-grey-light hover:bg-lol-gold-dark p-2 rounded cursor-pointer",children:(0,n.jsx)(r.iFH,{})}),(0,n.jsxs)("span",{className:"min-w-[4ch] text-center font-bold",children:[(100*e).toFixed(0),"%"]}),(0,n.jsx)("button",{onClick:t,className:"bg-lol-grey-light hover:bg-lol-gold-dark p-2 rounded cursor-pointer",children:(0,n.jsx)(r.wEH,{})})]})})}):null}var f=o(357);function h(){let[e,t]=(0,l.useState)(!0),[o,r]=(0,l.useState)({realtimeAdvice:"Conectando al coach...",buildRecommendation:{items:[],runes:[]},strategicAdvice:"Esperando la estrategia inicial...",priorityAction:"STATUS"}),[s,c]=(0,l.useState)(null),a=(0,l.useRef)(null);return((0,l.useEffect)(()=>{let e=f.env.NEXT_PUBLIC_WEBSOCKET_URL||"wss://lolmetamind-dmxt.onrender.com";return function t(){if(a.current&&a.current.readyState===WebSocket.OPEN)return;let o=new WebSocket("".concat(e,"?token=").concat("mock-token-bypass"));o.onopen=()=>{console.log("\uD83D\uDD17 Conectado al servidor WebSocket."),c(null)},o.onmessage=e=>{try{let t=JSON.parse(e.data);r(e=>({...e,...t}))}catch(e){console.error("Error al parsear el mensaje JSON:",e),c("Error en el formato de datos del servidor.")}},o.onclose=()=>{console.log("\uD83D\uDC94 Desconectado. Reintentando en 5 segundos..."),setTimeout(t,5e3)},o.onerror=e=>{console.error("❌ Error en WebSocket:",e),c("Error en la conexi\xf3n con el servidor."),o.close()},a.current=o}(),()=>{a.current&&a.current.close()}},[]),(0,l.useEffect)(()=>(window.electronAPI&&window.electronAPI.on("set-edit-mode",e=>{t(e)}),()=>{window.electronAPI&&"function"==typeof window.electronAPI.removeAllListeners&&window.electronAPI.removeAllListeners("set-edit-mode")}),[]),s)?(0,n.jsxs)("div",{className:"fixed top-0 left-0 p-2 rounded-lg bg-red-900/80 text-red-300 text-center z-50",children:["Error: ",s]}):(0,n.jsxs)(n.Fragment,{children:[e&&(0,n.jsx)(g,{}),(0,n.jsx)(d,{build:o.buildRecommendation}),(0,n.jsx)(u,{message:o.strategicAdvice}),(0,n.jsx)(m,{message:o.realtimeAdvice,priorityAction:o.priorityAction})]})}function b(){return(0,n.jsx)(a,{children:(0,n.jsx)(h,{})})}}},function(e){e.O(0,[699,933,971,23,744],function(){return e(e.s=8604)}),_N_E=e.O()}]);